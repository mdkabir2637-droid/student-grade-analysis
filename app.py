# -*- coding: utf-8 -*-
"""student_grade_analysis.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1EWyKKbgxKA9l-h2hR_6mqCUJd3uxik_7
"""
import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt

# -------------------------------
# Title
# -------------------------------
st.set_page_config(page_title="Student Grade Analysis", layout="wide")
st.title("ðŸŽ“ Student Grade Analysis using Python")
st.subheader("Capstone Project â€“ Data Analytics")

# -------------------------------
# Number of students
# -------------------------------
num_students = st.number_input(
    "Enter number of students",
    min_value=1,
    step=1
)

students = []

# -------------------------------
# Input section
# -------------------------------
for i in range(num_students):
    st.markdown(f"### Student {i+1}")
    roll = st.text_input(f"Roll Number {i+1}")
    name = st.text_input(f"Student Name {i+1}")
    marks = st.number_input(
        f"Marks of Student {i+1}",
        min_value=0,
        max_value=100,
        step=1
    )

    if roll and name:
        students.append([roll, name, marks])

# -------------------------------
# Generate Result
# -------------------------------
if st.button("Generate Result") and students:

    # DataFrame
    df = pd.DataFrame(students, columns=["Roll No", "Name", "Marks"])

    # Percentage
    df["Percentage"] = df["Marks"]

    # CGPA
    df["CGPA"] = (df["Percentage"] / 10).round(2)

    # Grade
    def calculate_grade(p):
        if p >= 80:
            return "A"
        elif p >= 60:
            return "B"
        elif p >= 40:
            return "C"
        else:
            return "D"

    df["Grade"] = df["Percentage"].apply(calculate_grade)

    # -------------------------------
    # Result Table
    # -------------------------------
    st.subheader("ðŸ“‹ Result Table")
    st.dataframe(df)

    # -------------------------------
    # Bar Graph (Marks)
    # -------------------------------
    st.subheader("ðŸ“Š Marks Bar Graph")

    fig, ax = plt.subplots()
    ax.bar(df["Name"], df["Marks"])
    ax.set_xlabel("Students")
    ax.set_ylabel("Marks")
    ax.set_title("Marks Comparison")
    st.pyplot(fig)

    # -------------------------------
    # Top & Low Performer
    # -------------------------------
    st.subheader("ðŸ† Performance Analysis")

    top_student = df.loc[df["Marks"].idxmax()]
    low_student = df.loc[df["Marks"].idxmin()]

    col1, col2 = st.columns(2)

    with col1:
        st.success(f"Top Performer: {top_student['Name']} ({top_student['Marks']} Marks)")

    with col2:
        st.error(f"Low Performer: {low_student['Name']} ({low_student['Marks']} Marks)")

    # -------------------------------
    # Subject Difficulty (Simple Logic)
    # -------------------------------
    st.subheader("ðŸ“˜ Subject Difficulty")

    avg_marks = df["Marks"].mean()

    if avg_marks >= 70:
        st.info("Subject Level: Easy")
    elif avg_marks >= 50:
        st.warning("Subject Level: Moderate")
    else:
        st.error("Subject Level: Difficult")

    # -------------------------------
    # Grade Distribution Pie Chart
    # -------------------------------
    st.subheader("ðŸ¥§ Grade Distribution (Pie Chart)")

    grade_counts = df["Grade"].value_counts()

    fig2, ax2 = plt.subplots()
    ax2.pie(
        grade_counts,
        labels=grade_counts.index,
        autopct="%1.1f%%",
        startangle=90
    )
    ax2.axis("equal")

    st.pyplot(fig2)

else:
    st.info("Please enter student details and click Generate Result")

